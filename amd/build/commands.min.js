define("tiny_ubicast/commands",["exports","./options"],(function(_exports,_options){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.create_video_link=create_video_link,_exports.getSetup=void 0;function create_video_link(course_id,use_filter,ubicast_url){const media_id=document.getElementById("id_mediaid").value,media_width=document.getElementById("id_mediawidth").value,media_height=document.getElementById("id_mediaheight").value,media_thumb=document.getElementById("id_mediaimg").value||"/static/mediaserver/images/video.svg";let video_url="";if(media_id)if(use_filter){video_url='<img class="atto_ubicast courseid_'+course_id+"_mediaid_"+media_id+'" style="display: block; width: '+media_width+"; height: "+media_height+' }};" src="'+(ubicast_url+media_thumb)+'" alt=""/>'}else{const url="/lib/editor/atto/plugins/ubicast/view.php?course="+course_id+" &video= + "+media_id;video_url='<iframe class="nudgis-iframe" style="width:'+media_width+"; height: "+media_height+'; background-color: #ddd;" src="'+window.M.cfg.wwwroot+url+'"  allow="autoplay; encrypted-media" allowfullscreen="allowfullscreen"></iframe>'}return video_url}_exports.getSetup=async()=>editor=>{editor.ui.registry.addButton("insert_media",{icon:"user",tooltip:"Insert media",onAction:()=>function(editor){const courseid=(0,_options.getCourseId)(editor),usefilter=(0,_options.useFilter)(editor),ubicastURL=(0,_options.getUbicastURL)(editor);window.console.log("Course id",courseid);const xhttp=new XMLHttpRequest;xhttp.onreadystatechange=function(){if(4===this.readyState&&200===this.status){const formId="id_resource_atto_ubicast_"+(new Date).getTime(),content=Y.Node.create(this.responseText);content.set("id",formId);const fieldset=content.one("fieldset");fieldset&&(fieldset.setStyle("overflow","auto"),fieldset.setStyle("padding","20px"),fieldset.setStyle("max-height",.7*window.innerHeight)),editor.windowManager.open({title:"Example plugin",body:{type:"panel",items:[{type:"htmlpanel",html:'<div id="content"></div>'}]},buttons:[{type:"cancel",text:"Close"},{type:"submit",text:"Save",buttonType:"primary"}],onSubmit:api=>{window.console.log("Course id",courseid);const video_link=create_video_link(courseid,usefilter,ubicastURL);editor.insertContent(video_link),api.close()}}),Y.one("#content").insert(content,"after"),setTimeout((function(){window.mediaSelector=new window.MediaSelector({moodleURL:window.M.cfg.wwwroot+"/mod/ubicast/lti.php?id="+courseid,nudgisURL:ubicastURL,filterBySpeaker:!0,target:formId})}),window.MediaSelector?10:2e3)}},xhttp.open("GET",window.M.cfg.wwwroot+"/lib/editor/atto/plugins/ubicast/media.php",!0),xhttp.send()}(editor)})}}));

//# sourceMappingURL=commands.min.js.map