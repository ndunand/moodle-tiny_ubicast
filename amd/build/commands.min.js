define("tiny_ubicast/commands",["exports","core/str","./common","./options"],(function(_exports,_str,_common,_options){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0;_exports.getSetup=async()=>{const[addCorrectionButtonTitle,removeCorrectionButtonTitle]=await Promise.all([(0,_str.get_string)("button_addcorrection",_common.component),(0,_str.get_string)("button_removecorrection",_common.component)]);return editor=>{editor.ui.registry.addButton(addCorrectionButtonTitle,{icon:"comment-add",tooltip:"Add correction",onAction:()=>function(editor){let correction_types_array=(0,_options.getCorrTypes)(editor).split("\n").map((line=>{let[value,text]=line.split("=");return{text:text,value:value}}));editor.windowManager.open({title:"Add a correction",body:{type:"panel",items:[{type:"selectbox",name:"correction_type",label:"Correction type",items:correction_types_array},{type:"textarea",name:"correction_comment",label:"Comment"}]},buttons:[{type:"submit",text:"OK"}],initialData:{correction_type:"none",correction_comment:""},onSubmit:api=>{const data=api.getData(),correction_type=data.correction_type,correction_comment=data.correction_comment;let whole_content=editor.getContent({format:"html"}),current_selection=editor.selection.getContent({}),updated_selection='<span class="tiny_ubicast">\n                    '.concat(current_selection,'\n                    <span class="tiny_ubicast_correction">\n                        <sup title="').concat(current_selection,'">').concat(correction_type,'</sup>\n                        <span class="tiny_ubicast_comment">').concat(correction_comment,"</span>\n                    </span>\n                </span>"),updated_content=whole_content.replace(current_selection,updated_selection);editor.setContent(updated_content),api.close()}})}(editor)}),editor.ui.registry.addButton(removeCorrectionButtonTitle,{icon:"comment",tooltip:"Remove correction",onAction:()=>function(editor){let selection=editor.selection.getNode();selection.classList.contains("tiny_ubicast")&&(selection.querySelector(".tiny_ubicast_correction").remove(),selection.attributes.removeNamedItem("class"))}(editor)})}}}));

//# sourceMappingURL=commands.min.js.map