define("tiny_ubicast/commands",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.create_video_link=create_video_link,_exports.getSetup=void 0;function create_video_link(course_id){const media_id=document.getElementById("id_mediaid").value,media_width=document.getElementById("id_mediawidth").value,media_height=document.getElementById("id_mediaheight").value;document.getElementById("id_mediaimg").value;let video_url="";if(media_id){const url="/lib/editor/atto/plugins/ubicast/view.php?course="+course_id+" &video= + "+media_id;video_url='<iframe class="nudgis-iframe" style="width:'+media_width+"; height: "+media_height+'; background-color: #ddd;" src="'+window.M.cfg.wwwroot+url+'"  allow="autoplay; encrypted-media" allowfullscreen="allowfullscreen"></iframe>'}return video_url}_exports.getSetup=async()=>editor=>{editor.ui.registry.addButton("insert_media",{icon:"user",tooltip:"Insert media",onAction:()=>function(editor){const urlParams=new URLSearchParams(window.location.search),course_id=parseInt(urlParams.get("course")),xhttp=new XMLHttpRequest;xhttp.onreadystatechange=function(){if(4===this.readyState&&200===this.status){const formId="id_resource_atto_ubicast_"+(new Date).getTime(),content=Y.Node.create(this.responseText);content.set("id",formId);const fieldset=content.one("fieldset");fieldset&&(fieldset.setStyle("overflow","auto"),fieldset.setStyle("padding","20px"),fieldset.setStyle("max-height",.7*window.innerHeight)),editor.windowManager.open({title:"Example plugin",body:{type:"panel",items:[{type:"htmlpanel",html:'<div id="content"></div>'}]},buttons:[{type:"cancel",text:"Close"},{type:"submit",text:"Save",buttonType:"primary"}],onSubmit:api=>{const video_link=create_video_link(course_id);editor.insertContent(video_link),api.close()}}),Y.one("#content").insert(content,"after"),setTimeout((function(){window.mediaSelector=new window.MediaSelector({moodleURL:window.M.cfg.wwwroot+"/mod/ubicast/lti.php?id="+course_id,nudgisURL:"https://tstrec.unil.ch",filterBySpeaker:!0,target:formId})}),window.MediaSelector?10:2e3)}},xhttp.open("GET",window.M.cfg.wwwroot+"/lib/editor/atto/plugins/ubicast/media.php",!0),xhttp.send()}(editor)})}}));

//# sourceMappingURL=commands.min.js.map